movie_payments.html>

<head lan="eng">
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Seat selecting</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="../../Assets/css/seat.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
</head>
<style>
    .banner {
        /* background-image:linear-gradient(to bottom, rgba(0,0,0,0), #151515), url(../../Assets/images/Vaathi/vaathi-about.jpg); */
        height: 300px;
        width: 60%;
        background-repeat: no-repeat;
        margin-left: 20%;
    }
</style>

<body>

    <!-- header logo -->


    <!-- movie banner -->
    <div class="banner">




    </div>

    <!-- screen text -->
    <div class="screen">
        <img src="../Assets/images/logo/arrow_.svg" id="screen-arrow-logo" alt="arrow">
        <h3>Screen on this way</h3>
    </div>

    <div class="seat_disclaimer">

        <div class="show-case">
            <p class="seat-prime selected"></p><label style="color: white;">SEAT SELECTED</label>
        </div>
       
       <div class="show-case"> 
        <p class="seat-prime"></p> <label style="color: white;">SEAT AVAILABLE</label>
       </div>
    <div class="show-case">  
    <p class="seat-prime occupied"></p><label style="color: white;">SEAT BOOKED</label>
    </div>

    </div>

    <div class="seatcost-budget">

        <select id="movie" style="display: none;">
            <option value="130"> Classic (Rs190.00)</option>
        </select>

        <h2>First class(Rs130)</h2>


    </div>




    <div class="container">
        <!-- seat budget -->
        <div class="seatprime-row2"  id="seat-prime-row1">

            <p class="seat-prime">A1</p>
            <p class="seat-prime">A2</p>
            <p class="seat-prime occupied">A3</p>
            <p class="seat-prime">A4</p>
            <p class="seat-prime">A5</p>
            <p class="seat-prime occupied">A6</p>
            <p class="seat-prime">A7</p>
            <p class="seat-prime occupied">A8</p>
            <p class="seat-prime">A9</p>
            <p class="seat-prime occupied">A10</p>
        </div>

        <div class="seatprime-row2" id="seat-prime-row1">

            <p class="seat-prime">B1</p>
            <p class="seat-prime">B2</p>
            <p class="seat-prime occupied">B3</p>
            <p class="seat-prime">B4</p>
            <p class="seat-prime">B5</p>
            <p class="seat-prime occupied">B6</p>
            <p class="seat-prime">B7</p>
            <p class="seat-prime">B8</p>
            <p class="seat-prime occupied">B9</p>
            <p class="seat-prime">B10</p>
        </div>

        <div class="seatcost-prime">


            <h2>Prime (130)</h2>
        </div>
        <!-- seat prime -->
        <div class="seatprime-row2">

            <p class="seat-prime occupied">C1</p>
            <p class="seat-prime">C2</p>
            <p class="seat-prime occupied">C3</p>
            <p class="seat-prime">C4</p>
            <p class="seat-prime occupied">C5</p>
            <p class="seat-prime occupied">C6</p>
            <p class="seat-prime">C7</p>
            <p class="seat-prime occupied">C8</p>
            <p class="seat-prime occupied">C9</p>
            <p class="seat-prime">C10</p>
            <p class="seat-prime occupied">C11</p>
            <p class="seat-prime">C12</p>
            <p class="seat-prime occupied">C13</p>
            <p class="seat-prime">C14</p>
            <p class="seat-prime occupied">C15</p>


        </div>

        <div class="seatprime-row2">

            <p class="seat-prime occupied">D1</p>
            <p class="seat-prime">D2</p>
            <p class="seat-prime">D3</p>
            <p class="seat-prime occupied">D4</p>
            <p class="seat-prime">D5</p>
            <p class="seat-prime">D6</p>
            <p class="seat-prime occupied">D7</p>
            <p class="seat-prime occupied">D8</p>
            <p class="seat-prime">D9</p>
            <p class="seat-prime">D10</p>
            <p class="seat-prime occupied">D11</p>
            <p class="seat-prime">D12</p>
            <p class="seat-prime occupied">D13</p>
            <p class="seat-prime occupied">D14</p>
            <p class="seat-prime">D15</p>


        </div>

        <div class="seatprime-row2">

            <p class="seat-prime">E1</p>
            <p class="seat-prime">E2</p>
            <p class="seat-prime">E3</p>
            <p class="seat-prime occupied">E4</p>
            <p class="seat-prime">E5</p>
            <p class="seat-prime">E6</p>
            <p class="seat-prime">E7</p>
            <p class="seat-prime">E8</p>
            <p class="seat-prime">E9</p>
            <p class="seat-prime">E10</p>
            <p class="seat-prime">E11</p>
            <p class="seat-prime">E12</p>
            <p class="seat-prime">E13</p>
            <p class="seat-prime">E14</p>
            <p class="seat-prime">E15</p>


        </div>

        <div class="seatprime-row2">

            <p class="seat-prime">F1</p>
            <p class="seat-prime">F2</p>
            <p class="seat-prime occupied">F3</p>
            <p class="seat-prime">F4</p>
            <p class="seat-prime occupied">F5</p>
            <p class="seat-prime">F6</p>
            <p class="seat-prime occupied">F7</p>
            <p class="seat-prime">F8</p>
            <p class="seat-prime occupied">F9</p>
            <p class="seat-prime">F10</p>
            <p class="seat-prime occupied">F11</p>
            <p class="seat-prime occupied">F12</p>
            <p class="seat-prime">F13</p>
            <p class="seat-prime">F14</p>
            <p class="seat-prime occupied">15</p>


        </div>
        <div class="seatprime-row2">

            <p class="seat-prime">G1</p>
            <p class="seat-prime">G2</p>
            <p class="seat-prime occupied">G3</p>
            <p class="seat-prime occupied">G4</p>
            <p class="seat-prime">G5</p>
            <p class="seat-prime">G6</p>
            <p class="seat-prime occupied">G7</p>
            <p class="seat-prime occupied">G8</p>
            <p class="seat-prime">G9</p>
            <p class="seat-prime">G10</p>
            <p class="seat-prime occupied">G11</p>
            <p class="seat-prime occupied">G12</p>
            <p class="seat-prime">G13</p>
            <p class="seat-prime occupied">G14</p>
            <p class="seat-prime">G15</p>


        </div>
        <div class="seatprime-row2">

            <p class="seat-prime occupied">H1</p>
            <p class="seat-prime">h2</p>
            <p class="seat-prime">H3</p>
            <p class="seat-prime occupied">H4</p>
            <p class="seat-prime">H5</p>
            <p class="seat-prime">H6</p>
            <p class="seat-prime occupied">H7</p>
            <p class="seat-prime">H8</p>
            <p class="seat-prime occupied">H9</p>
            <p class="seat-prime">H10</p>
            <p class="seat-prime occupied">H11</p>
            <p class="seat-prime">H12</p>
            <p class="seat-prime">H13</p>
            <p class="seat-prime occupied">H14</p>
            <p class="seat-prime">H15</p>


        </div>

        <div class="seatprime-row2">

            <p class="seat-prime">I1</p>
            <p class="seat-prime occupied">I2</p>
            <p class="seat-prime">I3</p>
            <p class="seat-prime occupied">14</p>
            <p class="seat-prime">I5</p>
            <p class="seat-prime occupied">I6</p>
            <p class="seat-prime">I7</p>
            <p class="seat-prime">I8</p>
            <p class="seat-prime occupied">I9</p>
            <p class="seat-prime">I10</p>
            <p class="seat-prime">I11</p>
            <p class="seat-prime occupied">I12</p>
            <p class="seat-prime">I13</p>
            <p class="seat-prime occupied">I14</p>
            <p class="seat-prime">I15</p>


        </div>

        <div class="seatprime-row2">

            <p class="seat-prime occupied">J1</p>
            <p class="seat-prime">J2</p>
            <p class="seat-prime occupied">J3</p>
            <p class="seat-prime">J4</p>
            <p class="seat-prime">J5</p>
            <p class="seat-prime occupied">J6</p>
            <p class="seat-prime">J7</p>
            <p class="seat-prime occupied">J8</p>
            <p class="seat-prime">J9</p>
            <p class="seat-prime occupied">J10</p>
            <p class="seat-prime">J11</p>
            <p class="seat-prime occupied">J12</p>
            <p class="seat-prime">J13</p>
            <p class="seat-prime occupied">J14</p>
            <p class="seat-prime">J15</p>

        </div>

    </div>

    <!-- seat prime -->
  <div class="foot">
    <div class="total_seatandcost">

        <div class="seat_total">
            <h3>SEAT INFO</h3>
            <span id="count">0</span>
        </div>

        <div class="theatre_details">

             <h3 id="theater_name" style="color:black"></h3>
            <span id="show_time"></span> 

            <span id="count_details"></span>
        </div>


        <div class="cost_total">

            <h3>TOTAL(INR)</h3>
            <span id="total">0</span>
        </div>


    </div>
    <div class="a-button">

    </div>


   
   </div>

    

    <i class="fa-solid fa-arrow-right arrowright"  ></i>

    <script>


        let users_booking= JSON.parse(localStorage.getItem("user_booking"));

        

        const theater_name=document.getElementById("theater_name");
        theater_name.innerHTML=users_booking[0]["theatre_name"];

        const show_time=document.getElementById("show_time");
        show_time.innerHTML=users_booking[0]["show_time"]


        let movie_list = JSON.parse(localStorage.getItem("show_movie_details"))


        const url = window.location.search;                // ?name=Arun
        const urlParams = new URLSearchParams(url);    //"name":"ponniyinselvan"    // converting string into key value pair
        const username = urlParams.get("name")             // return value of the "name" key
        console.log(username);


        let res;
        movie_list.find(function (e) {
            if (e["name"]["movie_name"] == username) { //arr[0],arr[1]  =e
                return res = e;
            }
            else {
                return res = 0;
            }
        });

    

        
        // let button= document.getElementById("button");


        let banner = document.querySelector(".banner");
        banner.style.backgroundImage = res["images"]["background_image"];

        let movie_name = document.createElement("h1");
        movie_name.innerText = res["name"]["movie_name"];
        banner.append(movie_name);



        let button_a=document.querySelector(".a-button");


        let button=document.createElement("button");
        button_a.append(button);

        let a = document.createElement("a");
        a.innerText = "submit";
        a.setAttribute("href", "movie_payment_page.html?name=" + res["name"]["movie_name"]);
        button.append(a);



        // let theatre = document.querySelector("theatre_name");

        let theatre_list = JSON.parse(localStorage.getItem("theatre_list"))


        const container = document.querySelector(".container");
        const seats = document.querySelectorAll('.seatprime-row2 .seat-prime:not(occupied')
        let count = document.getElementById("count");
        const total = document.getElementById('total');
        const movieselect = document.getElementById("movie");

        let ticketprice = +movieselect.value;



        function updateSelectedCount() {
            const selectedSeats = document.querySelectorAll('.seatprime-row2 .seat-prime.selected');

            const seatsIndex = [...selectedSeats].map(function (seat) {
                return [...seats].indexOf(seat)
            })

            // console.log(seatsIndex);

            // localStorage.setItem('selectedSeats', JSON.stringify(seatsIndex));

            const selectedSeatsCount = selectedSeats.length;

            count.innerText = selectedSeatsCount;


            total.innerText = selectedSeatsCount * ticketprice;

            console.log(total.innerText);


            let user_booking = JSON.parse(localStorage.getItem("user_booking")) ?? []
                        if (JSON.parse(localStorage.getItem("user_booking"))){
                              user_booking.find(e=>{
                                if(e["email"]== e.email){
                              e["seat_total"]=total.innerText
                                    
                                    
                                    localStorage.setItem("user_booking",JSON.stringify(user_booking))

                                }
                                else{
                                    let booking_data={
                                        "email":users.booking,
                                        "show_day":day,
                                        "show_date":date,
                                        "show_month":month,
                                         "theatre_name":theatre_name,
                                         "show_time":show_time,
                                    }
                                    user_booking.push(booking_data)

                                    // users.push(booking_data)

                                    localStorage.setItem("user_booking",JSON.stringify(user_booking))
                                }
                              })
                        }
                        localStorage.setItem("user", count_of_total_sets)

            
        }


        let output=""
        let count_of_total_sets=0;
        let count_details = document.querySelector("#count_details")


        container.addEventListener('click', (e) => {
            if (e.target.classList.contains('seat-prime') && !e.target.classList.contains('occupied')) {
                // console.log(e.target);
                e.target.classList.toggle('selected');
                // e.target.innerText= 

                let seat_total = document.querySelector(".seat_total")

                  count_of_total_sets++

                  console.log(count_of_total_sets);

                    if(count_of_total_sets <11){
                        count_details.innerText = count_of_total_sets;
                        count.innerText= e.target.innerText
                        output+=`<span id="count">${count.innerText}</span>`
                        seat_total.innerHTML=output;

                        console.log(count.innerText)

                    


                        let user_booking = JSON.parse(localStorage.getItem("user_booking")) ?? []
                        if (JSON.parse(localStorage.getItem("user_booking"))){
                              user_booking.find(e=>{
                                if(e["email"]== e.email){
                              e["seat_names"] =e["seat_names"]+","+count.innerText
                                    
                                    
                                    localStorage.setItem("user_booking",JSON.stringify(user_booking))

                                }
                                else{
                                    let booking_data={
                                        "email":users.booking,
                                        "show_day":day,
                                        "show_date":date,
                                        "show_month":month,
                                         "theatre_name":theatre_name,
                                         "show_time":show_time,
                                    }
                                    user_booking.push(booking_data)

                                    // users.push(booking_data)

                                    localStorage.setItem("user_booking",JSON.stringify(user_booking))
                                }
                              })
                        }
                        localStorage.setItem("user", count_of_total_sets)

                    }
                    else{
                        alert("You have only book 10 tickets at a time")
                    }

           

                }

            updateSelectedCount();

        });

        

        


    </script>




</body>

</html>